**변경감지(Dirty Checking)** 는 JPA의 핵심 기능 중 하나로, 엔티티 매니저가 엔티티 객체의 상태 변화를 자동으로 감지하고 관리하는 것이다. 이를 통해 엔티티 객체의 변경 사항을 명시적으로 추적하거나 저장할 필요가 없다.

#### 동작 방식

![](https://i.imgur.com/JzcbE6j.png)


1. **엔티티 조회**
    - 엔티티 매니저를 통해 엔티티 객체를 조회하면 해당 엔티티는 영속성 컨텍스트에 포함된다.

2. **엔티티 상태 변경**
    - 영속성 컨텍스트에 포함된 엔티티 객체의 값을 변경하면 JPA는 그 변경 사항을 자동으로 감지한다.

3. **플러시 시 변경 내용 반영**
    - 트랜잭션 커밋 시 또는 `em.flush()` 메서드 호출 시, JPA는 영속성 컨텍스트의 변경 내용을 데이터베이스에 반영한다.

#### 변경감지의 장점

- 엔티티 객체의 변경 사항을 직접 추적하거나 저장할 필요가 없어 코드가 간결해진다.
- 변경 내용이 자동으로 데이터베이스에 반영되어 데이터 무결성이 보장된다.
- 변경된 엔티티만 선별적으로 업데이트하므로 데이터베이스 부하가 감소한다.

---
변경감지는 엔티티 객체의 상태에 따라 다음과 같이 구분된다

- **새로운 상태(New)**: 아직 영속성 컨텍스트에 포함되지 않은 새로운 엔티티
- **영속 상태(Persistent)**: 영속성 컨텍스트에 포함되어 있는 엔티티
- **분리 상태(Detached)**: 영속성 컨텍스트에서 분리된 엔티티
- **제거 상태(Removed)**: 삭제 대상 엔티티